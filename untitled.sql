SELECT ua.user_id as user_id_left,
       u.user_id as user_id_right,
       order_id,
       time,
       action,
       sex,
       birth_date
FROM user_actions as ua
LEFT JOIN users as u
USING(user_id)
WHERE  u.user_id is not null
ORDER BY 1


SELECT f.status, f.member_name, SUM(p.unit_price * p.amount) as costs
FROM FamilyMembers as f
INNER JOIN Payments as p ON f.member_id = p.family_member
INNER JOIN Goods as g ON p.good = g.good_id
INNER JOIN GoodTypes as gt ON g.type = gt.good_type_id
WHERE gt.good_type_name = 'entertainment'
GROUP BY f.status, f.member_name
SELECT ua.user_id as user_id_left,
       u.user_id as user_id_right,
       order_id,
       time,
       action,
       sex,
       birth_date
FROM user_actions as ua
LEFT JOIN users as u
USING(user_id)
WHERE  u.user_id is not null
ORDER BY 1


SELECT f.status, f.member_name, SUM(p.unit_price * p.amount) as costs
FROM FamilyMembers as f
INNER JOIN Payments as p ON f.member_id = p.family_member
INNER JOIN Goods as g ON p.good = g.good_id
INNER JOIN GoodTypes as gt ON g.type = gt.good_type_id
WHERE gt.good_type_name = 'entertainment'
GROUP BY f.status, f.member_name
SELECT ua.user_id as user_id_left,
       u.user_id as user_id_right,
       order_id,
       time,
       action,
       sex,
       birth_date
FROM user_actions as ua
LEFT JOIN users as u
USING(user_id)
WHERE  u.user_id is not null
ORDER BY 1


SELECT f.status, f.member_name, SUM(p.unit_price * p.amount) as costs
FROM FamilyMembers as f
INNER JOIN Payments as p ON f.member_id = p.family_member
INNER JOIN Goods as g ON p.good = g.good_id
INNER JOIN GoodTypes as gt ON g.type = gt.good_type_id
WHERE gt.good_type_name = 'entertainment'
GROUP BY f.status, f.member_name
SELECT ua.user_id as user_id_left,
       u.user_id as user_id_right,
       order_id,
       time,
       action,
       sex,
       birth_date
FROM user_actions as ua
LEFT JOIN users as u
USING(user_id)
WHERE  u.user_id is not null
ORDER BY 1


SELECT f.status, f.member_name, SUM(p.unit_price * p.amount) as costs
FROM FamilyMembers as f
INNER JOIN Payments as p ON f.member_id = p.family_member
INNER JOIN Goods as g ON p.good = g.good_id
INNER JOIN GoodTypes as gt ON g.type = gt.good_type_id
WHERE gt.good_type_name = 'entertainment'
GROUP BY f.status, f.member_name
SELECT ua.user_id as user_id_left,
       u.user_id as user_id_right,
       order_id,
       time,
       action,
       sex,
       birth_date
FROM user_actions as ua
LEFT JOIN users as u
USING(user_id)
WHERE  u.user_id is not null
ORDER BY 1


SELECT f.status, f.member_name, SUM(p.unit_price * p.amount) as costs
FROM FamilyMembers as f
INNER JOIN Payments as p ON f.member_id = p.family_member
INNER JOIN Goods as g ON p.good = g.good_id
INNER JOIN GoodTypes as gt ON g.type = gt.good_type_id
WHERE gt.good_type_name = 'entertainment'
GROUP BY f.status, f.member_name
SELECT ua.user_id as user_id_left,
       u.user_id as user_id_right,
       order_id,
       time,
       action,
       sex,
       birth_date
FROM user_actions as ua
LEFT JOIN users as u
USING(user_id)
WHERE  u.user_id is not null
ORDER BY 1


SELECT f.status, f.member_name, SUM(p.unit_price * p.amount) as costs
FROM FamilyMembers as f
INNER JOIN Payments as p ON f.member_id = p.family_member
INNER JOIN Goods as g ON p.good = g.good_id
INNER JOIN GoodTypes as gt ON g.type = gt.good_type_id
WHERE gt.good_type_name = 'entertainment'
GROUP BY f.status, f.member_name
SELECT ua.user_id as user_id_left,
       u.user_id as user_id_right,
       order_id,
       time,
       action,
       sex,
       birth_date
FROM user_actions as ua
LEFT JOIN users as u
USING(user_id)
WHERE  u.user_id is not null
ORDER BY 1


SELECT f.status, f.member_name, SUM(p.unit_price * p.amount) as costs
FROM FamilyMembers as f
INNER JOIN Payments as p ON f.member_id = p.family_member
INNER JOIN Goods as g ON p.good = g.good_id
INNER JOIN GoodTypes as gt ON g.type = gt.good_type_id
WHERE gt.good_type_name = 'entertainment'
GROUP BY f.status, f.member_name
SELECT ua.user_id as user_id_left,
       u.user_id as user_id_right,
       order_id,
       time,
       action,
       sex,
       birth_date
FROM user_actions as ua
LEFT JOIN users as u
USING(user_id)
WHERE  u.user_id is not null
ORDER BY 1


SELECT f.status, f.member_name, SUM(p.unit_price * p.amount) as costs
FROM FamilyMembers as f
INNER JOIN Payments as p ON f.member_id = p.family_member
INNER JOIN Goods as g ON p.good = g.good_id
INNER JOIN GoodTypes as gt ON g.type = gt.good_type_id
WHERE gt.good_type_name = 'entertainment'
GROUP BY f.status, f.member_name
SELECT ua.user_id as user_id_left,
       u.user_id as user_id_right,
       order_id,
       time,
       action,
       sex,
       birth_date
FROM user_actions as ua
LEFT JOIN users as u
USING(user_id)
WHERE  u.user_id is not null
ORDER BY 1


SELECT f.status, f.member_name, SUM(p.unit_price * p.amount) as costs
FROM FamilyMembers as f
INNER JOIN Payments as p ON f.member_id = p.family_member
INNER JOIN Goods as g ON p.good = g.good_id
INNER JOIN GoodTypes as gt ON g.type = gt.good_type_id
WHERE gt.good_type_name = 'entertainment'
GROUP BY f.status, f.member_name
SELECT ua.user_id as user_id_left,
       u.user_id as user_id_right,
       order_id,
       time,
       action,
       sex,
       birth_date
FROM user_actions as ua
LEFT JOIN users as u
USING(user_id)
WHERE  u.user_id is not null
ORDER BY 1


SELECT f.status, f.member_name, SUM(p.unit_price * p.amount) as costs
FROM FamilyMembers as f
INNER JOIN Payments as p ON f.member_id = p.family_member
INNER JOIN Goods as g ON p.good = g.good_id
INNER JOIN GoodTypes as gt ON g.type = gt.good_type_id
WHERE gt.good_type_name = 'entertainment'
GROUP BY f.status, f.member_name
